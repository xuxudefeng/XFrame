<!DOCTYPE html>
<!-- saved from url=(0054)https://joshclose.github.io/CsvHelper/getting-started/ -->
<html lang="zh-CN" class="fontawesome-i2svg-active fontawesome-i2svg-complete translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style type="text/css">svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top left;transform-origin:top left}.fa-lg{font-size:1.3333333333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:solid .08em #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.fa-rotate-90{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.fa-flip-vertical{-webkit-transform:scale(1,-1);transform:scale(1,-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1,-1);transform:scale(-1,-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor);opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fad.fa-inverse{color:#fff}</style><link rel="apple-touch-icon" sizes="57x57" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="https://joshclose.github.io/CsvHelper/favicons/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192" href="https://joshclose.github.io/CsvHelper/favicons/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://joshclose.github.io/CsvHelper/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="https://joshclose.github.io/CsvHelper/favicons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://joshclose.github.io/CsvHelper/favicons/favicon-16x16.png">
	<link rel="manifest" href="https://joshclose.github.io/CsvHelper/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
	<title>入门 |  CSVHelper</title>

	
	
		<link rel="stylesheet" href="./入门 _ CSVHelper_files/bulma.min.css">
	
	<link rel="stylesheet" href="./入门 _ CSVHelper_files/default.min.css">
	<link rel="stylesheet" href="./入门 _ CSVHelper_files/vs.min.css">
	<link rel="stylesheet" href="./入门 _ CSVHelper_files/index.css">

	<script defer="" src="./入门 _ CSVHelper_files/all.js.下载"></script>
	<script src="./入门 _ CSVHelper_files/highlight.min.js.下载"></script>
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./入门 _ CSVHelper_files/translateelement.css"></head>
<body>
	<header id="header" class="header">
	<nav class="navbar is-light">
		<div class="navbar-brand">
			<a class="navbar-item" href="https://joshclose.github.io/CsvHelper">
				<img src="./入门 _ CSVHelper_files/logo.svg" width="66" height="28">
			</a>
			<div id="navbar-burger" class="navbar-burger">
				<span></span>
				<span></span>
				<span></span>
			</div>
		</div>
		<div id="navbar-menu" class="navbar-menu">
			<div class="navbar-start">
				<a class="navbar-item" href="https://joshclose.github.io/CsvHelper/getting-started"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入门</font></font></a>
				<a class="navbar-item" href="https://joshclose.github.io/CsvHelper/examples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例子</font></font></a>
				<a class="navbar-item" href="https://joshclose.github.io/CsvHelper/migration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">移民</font></font></a>
				<a class="navbar-item" href="https://joshclose.github.io/CsvHelper/change-log"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改日志</font></font></a>
			</div>
			<div class="navbar-end">
				<a class="navbar-item" href="https://twitter.com/JoshClose">
					<span class="icon">
						<svg class="svg-inline--fa fa-twitter fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg><!-- <i class="fab fa-twitter"></i> -->
					</span>
				</a>
				<a class="navbar-item" href="https://github.com/JoshClose/CsvHelper">
					<span class="icon">
						<svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github"></i> -->
					</span>
				</a>
			</div>
		</div>
	</nav>
</header>


	<main id="main" class="container is-fluid">
		<div class="columns is-variable is-1">
					<div class="column is-2">
						
<div id="sidebar" class="sidebar" style="top: 52px; bottom: 0px; width: 299.828px;">
	<ul class="">
		<li>
	<span>

		<a href="https://joshclose.github.io/CsvHelper/getting-started/#installation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></a>
	</span>

</li>

		<li>
	<span>

		<a href="https://joshclose.github.io/CsvHelper/getting-started/#cultureinfo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文化资讯</font></font></a>
	</span>

</li>

		<li>
	<span>

		<a href="https://joshclose.github.io/CsvHelper/getting-started/#newlines"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">换行符</font></font></a>
	</span>

</li>

		<li>
	<span>

		<a href="https://joshclose.github.io/CsvHelper/getting-started/#reading-a-csv-file"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读取 CSV 文件</font></font></a>
	</span>

</li>

		<li>
	<span>

		<a href="https://joshclose.github.io/CsvHelper/getting-started/#writing-a-csv-file"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编写 CSV 文件</font></font></a>
	</span>

</li>

		<li>
	<span>

		<a href="https://joshclose.github.io/CsvHelper/getting-started/#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回到顶部</font></font></a>
	</span>

</li>

</ul>

</div>

					</div>
				<div class="column">
					<div class="content">
						<h1 id="getting-started"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入门</font></font></h1>
<h2 id="installation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></h2>
<hr>
<h3 id="package-manager-console"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包管理器控制台</font></font></h3>
<pre><code class="hljs shell"><span class="hljs-meta">PM&gt;</span><span class="bash"> Install-Package CsvHelper</span>
</code></pre>
<h3 id="net-cli-console"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.NET CLI 控制台</font></font></h3>
<pre><code class="hljs csharp">&gt; dotnet <span class="hljs-keyword">add</span> package CsvHelper
</code></pre>
<h2 id="prerequisites"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先决条件</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用本文档时，隐含了一些基本的 .NET 知识。</font><font style="vertical-align: inherit;">请查看先决条件以确保您了解它们。</font></font><a href="https://joshclose.github.io/CsvHelper/examples/prerequisites"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先决条件</font></font></a></p>
<h2 id="cultureinfo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文化资讯</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CsvHelper 要求您指定</font></font><code>CultureInfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用的。</font><font style="vertical-align: inherit;">区域性用于确定类型转换时的默认分隔符、默认行尾和格式。</font><font style="vertical-align: inherit;">如果您愿意，您也可以更改其中任何一个的配置。</font><font style="vertical-align: inherit;">为您的数据选择合适的文化。</font></font><code>InvariantCulture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将是写入文件并再次读取它的最便携的，因此将在大多数示例中使用。</font></font></p>
<h2 id="newlines"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">换行符</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，</font><font style="vertical-align: inherit;">无论您在什么操作系统上运行，CsvHelper 都将遵循</font></font><a href="https://tools.ietf.org/html/rfc4180#page-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC 4180</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并用于编写换行符。</font></font><code>\r\n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CsvHelper 可以读取</font></font><code>\r\n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>\r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>\n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不进行任何配置更改。</font><font style="vertical-align: inherit;">如果您想以非标准格式读取或写入，您可以更改</font></font><code>NewLine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">var</span> config = <span class="hljs-keyword">new</span> CsvConfiguration(CultureInfo.InvariantCulture)<font></font>
{<font></font>
    NewLine = Environment.NewLine,<font></font>
};<font></font>
</code></pre>
<h2 id="reading-a-csv-file"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读取 CSV 文件</font></font></h2>
<hr>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假设我们有这样的 CSV 文件。</font></font></p>
<pre><code class="hljs sql">Id,Name
<span class="hljs-number">1</span>,<span class="hljs-keyword">one</span>
<span class="hljs-number">2</span>,two
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有一个看起来像这样的类定义。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果我们的类属性名称与我们的 CSV 文件头名称匹配，我们可以在没有任何配置的情况下读取该文件。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader, CultureInfo.InvariantCulture))<font></font>
{<font></font>
    <span class="hljs-keyword">var</span> records = csv.GetRecords&lt;Foo&gt;();<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>GetRecords&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法将返回一个</font></font><code>IEnumerable&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font><code>yield</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记录的内容。</font><font style="vertical-align: inherit;">这意味着在您迭代记录时一次只返回一条记录。</font><font style="vertical-align: inherit;">这也意味着只有一小部分文件被读入内存。</font><font style="vertical-align: inherit;">不过要小心。</font><font style="vertical-align: inherit;">如果您执行任何执行 LINQ 投影的操作，例如调用</font></font><code>.ToList()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则整个文件将被读入内存。</font></font><code>CsvReader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅转发，因此如果您想对您的数据运行任何 LINQ 查询，您必须将整个文件拉入内存。</font><font style="vertical-align: inherit;">只要知道这就是你在做什么。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假设我们的 CSV 文件名与我们的类属性有点不同，我们不想让我们的属性匹配。</font></font></p>
<pre><code class="hljs objectivec"><span class="hljs-keyword">id</span>,name
<span class="hljs-number">1</span>,one
<span class="hljs-number">2</span>,two
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这种情况下，名称是小写的。</font><font style="vertical-align: inherit;">我们希望我们的属性名称是 Pascal Case，所以我们可以改变我们的属性如何与标题名称匹配。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">var</span> config = <span class="hljs-keyword">new</span> CsvConfiguration(CultureInfo.InvariantCulture)<font></font>
{<font></font>
    PrepareHeaderForMatch = args =&gt; args.Header.ToLower(),<font></font>
};<font></font>
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader, config))<font></font>
{<font></font>
    <span class="hljs-keyword">var</span> records = csv.GetRecords&lt;Foo&gt;();<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用配置</font></font><code>PrepareHeaderForMatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我们能够更改标头匹配对属性名称进行的方式。</font><font style="vertical-align: inherit;">标头和属性名称都通过
</font></font><code>PrepareHeaderForMatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数运行。</font><font style="vertical-align: inherit;">当读者需要找到要为标题设置的属性时，它们现在将匹配。</font><font style="vertical-align: inherit;">您可以使用此功能执行其他操作，例如删除空格或其他字符。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假设 CSV 文件根本没有标题。</font></font></p>
<pre><code class="hljs sql"><span class="hljs-number">1</span>,<span class="hljs-keyword">one</span>
<span class="hljs-number">2</span>,two
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先我们需要告诉读者没有头记录，使用配置。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">var</span> config = <span class="hljs-keyword">new</span> CsvConfiguration(CultureInfo.InvariantCulture)<font></font>
{<font></font>
    HasHeaderRecord = <span class="hljs-literal">false</span>,<font></font>
};<font></font>
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader, config))<font></font>
{<font></font>
    <span class="hljs-keyword">var</span> records = csv.GetRecords&lt;Foo&gt;();<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CsvReader 将使用类中属性的位置作为索引位置。</font><font style="vertical-align: inherit;">但是，这有一个问题。</font></font><a href="https://blogs.msdn.microsoft.com/haibo_luo/2006/07/10/member-order-returned-by-getfields-getmethods/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您不能依赖 .NET 中类成员的顺序</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">我们可以通过将属性映射到 CSV 文件中的位置来解决这个问题。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一种方法是使用属性映射。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span><font></font>
{<font></font>
    [<span class="hljs-meta">Index(0)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
    [<span class="hljs-meta">Index(1)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"></font><code>IndexAttribute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许您指定要用于属性的 CSV 字段的位置</font><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您也可以按名称映射。</font><font style="vertical-align: inherit;">让我们使用之前的小写标题示例，看看我们如何使用属性而不是更改标题匹配。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span><font></font>
{<font></font>
    [<span class="hljs-meta">Name(<span class="hljs-meta-string">"id"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
    [<span class="hljs-meta">Name(<span class="hljs-meta-string">"name"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
}<font></font>
</code></pre>
<p><a href="https://joshclose.github.io/CsvHelper/api/CsvHelper.Configuration.Attributes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以使用许多其他属性。</font></font></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果我们无法控制我们想要映射到的类，所以我们不能向它添加属性怎么办？</font><font style="vertical-align: inherit;">在这种情况下，我们可以使用 fluent</font></font><code>ClassMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行映射。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FooMap</span> : <span class="hljs-title">ClassMap</span>&lt;<span class="hljs-title">Foo</span>&gt;<font></font>
{<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FooMap</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        Map(m =&gt; m.Id).Name(<span class="hljs-string">"id"</span>);<font></font>
        Map(m =&gt; m.Name).Name(<span class="hljs-string">"name"</span>);<font></font>
    }<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用映射，我们需要在上下文中注册它。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader, CultureInfo.InvariantCulture))<font></font>
{<font></font>
    csv.Context.RegisterClassMap&lt;FooMap&gt;();<font></font>
    <span class="hljs-keyword">var</span> records = csv.GetRecords&lt;Foo&gt;();<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建类映射是在 CsvHelper 中映射文件的推荐方法，因为它更强大。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您也可以手动读取行。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader, CultureInfo.InvariantCulture))<font></font>
{<font></font>
    csv.Read();<font></font>
    csv.ReadHeader();<font></font>
    <span class="hljs-keyword">while</span> (csv.Read())<font></font>
    {<font></font>
        <span class="hljs-keyword">var</span> <span class="hljs-keyword">record</span> = csv.GetRecord&lt;Foo&gt;();
        <span class="hljs-comment">// Do something with the record.</span><font></font>
    }<font></font>
}<font></font>
</code></pre>
<p><code>Read</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会提前排。</font></font><code>ReadHeader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会将行作为标题值读入 CsvHelper。</font><font style="vertical-align: inherit;">分离</font></font><code>Read</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>ReadHeader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许您在移动到下一行之前对标题行执行其他操作。</font></font><code>GetRecord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也不会让读者对可能需要做的行做其他事情。</font><font style="vertical-align: inherit;">您可能需要</font></font><code>GetField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单个字段或</font></font><code>GetRecord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多次调用以填充多个对象。</font></font></p>
<h2 id="writing-a-csv-file"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编写 CSV 文件</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在让我们看看如何编写 CSV 文件。</font><font style="vertical-align: inherit;">基本上是一样的，只是顺序相反。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们使用与以前相同的类定义。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们有一组这样的记录。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">var</span> records = <span class="hljs-keyword">new</span> List&lt;Foo&gt;<font></font>
{<font></font>
    <span class="hljs-keyword">new</span> Foo { Id = <span class="hljs-number">1</span>, Name = <span class="hljs-string">"one"</span> },
    <span class="hljs-keyword">new</span> Foo { Id = <span class="hljs-number">2</span>, Name = <span class="hljs-string">"two"</span> },<font></font>
};<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们可以将记录写入文件而无需任何配置。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> writer = <span class="hljs-keyword">new</span> StreamWriter(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvWriter(writer, CultureInfo.InvariantCulture))<font></font>
{<font></font>
    csv.WriteRecords(records);<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>WriteRecords</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法会将所有记录写入文件。</font><font style="vertical-align: inherit;">完成写入后，您应该调用</font></font><code>writer.Flush()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确保写入器内部缓冲区中的所有数据都已刷新到文件中。</font><font style="vertical-align: inherit;">一旦一个</font></font><code>using</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块退出，作者就会自动刷新，所以我们不必在这里显式地这样做。</font><font style="vertical-align: inherit;">建议始终
用</font><font style="vertical-align: inherit;">块包裹任何</font></font><code>IDisposable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象。</font><font style="vertical-align: inherit;">该对象将在块退出</font></font><code>using</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后尽快处理自己（在我们的例子中也是刷新） 。</font></font><code>using</code><font style="vertical-align: inherit;"></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还记得我们如何不能依赖 .NET 中的属性顺序吗？</font><font style="vertical-align: inherit;">如果我们正在编写一个有标题的类，那没关系，只要我们稍后使用标题读取即可。</font><font style="vertical-align: inherit;">如果我们想在 CSV 文件中定位标题，我们需要指定一个索引来保证它的顺序。</font><font style="vertical-align: inherit;">建议在写入时始终设置索引。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FooMap</span> : <span class="hljs-title">ClassMap</span>&lt;<span class="hljs-title">Foo</span>&gt;<font></font>
{<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FooMap</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        Map(m =&gt; m.Id).Index(<span class="hljs-number">0</span>).Name(<span class="hljs-string">"id"</span>);<font></font>
        Map(m =&gt; m.Name).Index(<span class="hljs-number">1</span>).Name(<span class="hljs-string">"name"</span>);<font></font>
    }<font></font>
}<font></font>
</code></pre>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您也可以手写行。</font></font></p>
<pre><code class="language-cs hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> writer = <span class="hljs-keyword">new</span> StreamWriter(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvWriter(writer, CultureInfo.InvariantCulture))<font></font>
{<font></font>
    csv.WriteHeader&lt;Foo&gt;();<font></font>
    csv.NextRecord();<font></font>
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> <span class="hljs-keyword">record</span> <span class="hljs-title">in</span> <span class="hljs-title">records</span>)<font></font>
    {<font></font>
        csv.WriteRecord(<span class="hljs-keyword">record</span>);<font></font>
        csv.NextRecord();<font></font>
    }<font></font>
}<font></font>
</code></pre>
<p><code>WriteHeader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会将您推进到下一行。</font><font style="vertical-align: inherit;">
如果需要，分离允许您在标题中写入更多</font></font><code>NextRecord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">也不会将您推进到下一行以使您能够编写多个对象或用于
</font><font style="vertical-align: inherit;">编写单个字段。</font></font><code>WriteHeader</code><font style="vertical-align: inherit;"></font><code>WriteRecord</code><font style="vertical-align: inherit;"></font><code>WriteField</code><font style="vertical-align: inherit;"></font></p>
<br>

					</div>
				</div>
		</div>
	</main>

	<br><br>

	<footer id="footer" class="footer">
	<div class="has-text-centered"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">© 2009-2021 乔什关闭</font></font></div>
</footer>



	<script>
		hljs.configure({
			tabReplace: "    "
		});
		hljs.initHighlightingOnLoad();
	</script>
	<script src="./入门 _ CSVHelper_files/header.js.下载"></script>
	<script src="./入门 _ CSVHelper_files/sidebar.js.下载"></script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./入门 _ CSVHelper_files/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>
	


<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>